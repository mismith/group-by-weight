"use strict";angular.module("miUtil",[]).run(["$rootScope","$document","$timeout",function(e,t,n){FastClick&&FastClick.attach(document.body),viewportUnitsBuggyfill&&viewportUnitsBuggyfill.init();var o=e.$menu={active:!1,open:function(e){o.active=!0,e&&e.stopPropagation()},close:function(e){o.active=!1,e&&e.stopPropagation()},toggle:function(e){o.active=!o.active,e&&e.stopPropagation()}};t.on("click",function(){n(function(){o.close()})}),t.on("keyup",function(e){27===e.keyCode&&n(function(){o.close()})}),e.miUtilPreventScrollOnMenuActive=!0,e.$watch("$menu.active",function(t){e.miUtilPreventScrollOnMenuActive&&angular.element(document.body).css({overflow:t?"hidden":""})});var i=e.$modal={active:!1,open:function(e){i.active=e},close:function(){i.active=!1},toggle:function(e){i.active=i.active===e?!1:e},isOpen:function(e){return i.active===e}};t.on("keyup",function(e){27===e.keyCode&&n(function(){i.close()})}),e.$watch("$modal.active",function(t){angular.element(document.body).css({overflow:t?"hidden":""}),e.$broadcast("$modal."+(t?"open":"close"))})}]).filter("length",function(){return function(e){return angular.isArray(e)?e.length:angular.isObject(e)?Object.keys(e).filter(function(e){return"$"!=e[0]}).length:0}}).filter("unique",function(){return function(e,t){if(!e)return e;for(var n={},o=[],i=0;i<e.length;i++)n[angular.isFunction(t)?t(e[i]):e[i][t]]=e[i];for(var a in n)o.push(n[a]);return o}}).directive("miIcon",function(){return{scope:{svg:"@",size:"@"},restrict:"E",replace:!0,templateNamespace:"svg",template:'<svg xmlns="http://www.w3.org/2000/svg" class="mi-icon" style="display: inline-block; width: {{ size || 16 }}px; height: {{ size || 16 }}px; fill: currentColor; vertical-align: middle;"><use xlink:href="" /></svg>',link:function(e,t,n){n.$observe("svg",function(e){t.children().attr("xlink:href","assets/icons.svg#"+e)})}}}).directive("miModal",function(){return{scope:{id:"@"},restrict:"E",replace:!0,transclude:!0,template:'<aside ng-show="$modal.isOpen(id)" ng-click="$modal.close()" class="mi-modal-container" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0;">\n				<div class="mi-modal">\n					<div ng-click="$event.stopPropagation()" class="mi-modal-content" ng-transclude></div>\n					<a ng-click="$modal.close()" class="mi-modal-close">\n						<mi-icon svg="x"></mi-icon>\n					</a>\n				</div>\n			</aside>'}}).directive("miClickToggle",["$timeout","$parse",function(e,t){return{restrict:"A",link:function(n,o,i){var a=n.$eval(i.miClickToggle);o.on("click",function(o){o.preventDefault(),e(function(){angular.forEach(a,function(e,o){return t(o).assign(n,e)})})}),angular.forEach(a,function(e,t){n.$watch(t,function(t){void 0!==t&&o[e===t?"addClass":"removeClass"](n.$eval(i.miClickToggleActive)||"active")})})}}}]),angular.module("group-by-weight",[]).controller("AppCtrl",["$scope","$timeout","$window",function(e,t,n){function o(e,t){if(e&&t){var n=e.getBoundingClientRect(),o=t.getBoundingClientRect(),i=o.left-(n.left+n.width);return"M0 "+n.top+" C"+i/2+" "+n.top+", "+i/2+" "+o.top+", "+i+" "+o.top+" v"+o.height+" C"+i/2+" "+(o.top+o.height)+", "+i/2+" "+(n.top+n.height)+", 0 "+(n.top+n.height)+" v"+-n.height}}e.groups=[{$id:1,name:"Alcohol",items:[]},{$id:2,name:"Entertainment",items:[]},{$id:0,name:"Food",items:[]},{$id:3,name:"Household",items:[]},{$id:4,name:"Lifestyle",items:[]},{$id:5,name:"Ignore",items:[],background:"rgba(0,0,0,.2)"}],e.colors=[],e.$watch("groups",function(t){e.colors=[];for(var n=0;360>n;n+=360/t.length)e.colors.push("hsla("+n+", "+(90+10*Math.random())+"%, "+(50+10*Math.random())+"%, .2)")});var i=function(t){e.$apply()};angular.element(n).on("load resize",i),e.weightByLength=function(e){return o(document.getElementById("input"+e),document.getElementById("output"+e))},e.weightBySum=function(e){return o(document.getElementById("output"+e),document.getElementById("exput"+e))};var a=[];e.select=function(e,t){var n=a.indexOf(e);return 0>n?t?a.push(e):a.splice(0,a.length,e):a.splice(n,1),a},e.selected=function(e){return a.indexOf(e)>=0},e.sum=function(e){return e.$sum=0,e.items.map(function(t){return e.$sum+=t.amount}),e.$sum},e.len=function(e){return e.$len=e.items.length||0},e.abs=function(e){return Math.abs(e)},e.moveItem=function(e,t,n){n.push(e.splice(parseInt(t),1)[0])},e.parseCSV=function(n){var o=new FileReader;o.onload=function(n){t(function(){e.items=[],CSV.parse(n.target.result).map(function(t,n){n&&e.items.push({name:t[4]+"\n"+t[5],date:t[2],amount:parseFloat(t[6].toString().replace(/\(([^\)]+)\)/g,"-$1").replace(/[^\d\.\-]/g,""))})})})},o.readAsText(n[0])}}]).directive("drag",["$rootScope","$parse","$timeout",function(e,t,n){return{restrict:"A",link:function(o,i,a){var r=!0,c=a.dragEffect||"move";i[0].draggable=!0,i.on("dragstart",function(l){r&&(l.stopPropagation(),l.dataTransfer.effectAllowed=c,e.$dragDropData=t(a.drag)(o),i.addClass("dragging"),n(function(){t(a.dragStart)(o,{$event:l,$element:i})}))}),i.on("dragend",function(c){r&&(i.removeClass("dragging"),n(function(){t(a.dragEnd)(o,{$event:c,$element:i,$data:e.$dragDropData}),e.$dragDropData=void 0}))})}}}]).directive("dragDrop",["$rootScope","$parse","$timeout",function(e,t,n){return{restrict:"A",link:function(o,i,a){var r=a.dragEffect||"move";i.on("dragover",function(c){c.preventDefault(),c.stopPropagation(),c.dataTransfer.dropEffect=r,i.addClass("dragover"),n(function(){t(a.dragOver)(o,{$event:c,$element:i,$data:e.$dragDropData})})}),i.on("dragenter",function(r){r.preventDefault(),r.stopPropagation(),i.addClass("dragover"),n(function(){t(a.dragEnter)(o,{$event:r,$element:i,$data:e.$dragDropData})})}),i.on("dragleave",function(r){r.preventDefault(),r.stopPropagation(),i.removeClass("dragover"),n(function(){t(a.dragLeave)(o,{$event:r,$element:i,$data:e.$dragDropData})})}),i.on("drop",function(r){r.preventDefault(),r.stopPropagation(),i.removeClass("dragover"),n(function(){t(a.dragDrop)(o,{$event:r,$element:i,$data:e.$dragDropData})})})}}}]).directive("fileChange",["$parse",function(e){return{restrict:"A",link:function(t,n,o){n.on("change",function(n){e(o.fileChange)(t,{$event:n})})}}}]);